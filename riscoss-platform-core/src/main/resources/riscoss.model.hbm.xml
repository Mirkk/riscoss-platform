<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD//EN"
    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class name="eu.riscoss.api.model.Scope" table="SCOPES">
    <id name="id"/>
    <discriminator column="SCOPE_TYPE"/>
    <property name="name"/>
    <property name="description"/>

    <subclass name="eu.riscoss.api.model.Company" discriminator-value="COMPANY">
      <list name="products">
        <key column="PRODUCTS_FOR_COMPANY"/>
        <list-index column="id"/>
        <one-to-many class="eu.riscoss.api.model.Product"/>
      </list>
    </subclass>

    <subclass name="eu.riscoss.api.model.Product" discriminator-value="PRODUCT">
      <many-to-one name="company" class="eu.riscoss.api.model.Company"/>
      <list name="components">
        <key column="COMPONENTS_FOR_PRODUCT"/>
        <list-index column="id"/>
        <many-to-many class="eu.riscoss.api.model.Component"/>
      </list>
    </subclass>

    <subclass name="eu.riscoss.api.model.Project" discriminator-value="PROJECT"/>

    <subclass name="eu.riscoss.api.model.Component" discriminator-value="COMPONENT">
      <property name="version"/>
      <list name="products">
        <key column="PRODUCTS_FOR_COMPONENT"/>
        <list-index column="id"/>
        <many-to-many class="eu.riscoss.api.model.Product"/>
      </list>

      <subclass name="eu.riscoss.api.model.OSSComponent" discriminator-value="OSSCOMPONENT">
        <property name="webSite"/>
      </subclass>
    </subclass>
  </class>

  <class name="eu.riscoss.api.model.Measurement" table="MEASUREMENTS">
    <id name="id">
      <generator class="native"/>
    </id>
    <many-to-one name="scope" class="eu.riscoss.api.model.Scope"/>
    <property name="type" not-null="true"/>
    <property name="date" type="timestamp" not-null="true"/>
    <property name="value" type="text" not-null="true"/>
  </class>

  <class name="eu.riscoss.api.model.Indicator" table="INDICATORS">
    <composite-id>
      <key-property name="type"/>
      <key-many-to-one name="scope" class="eu.riscoss.api.model.Scope"/>
    </composite-id>
    <property name="date" type="timestamp" not-null="true"/>
    <property name="value" type="text" not-null="true"/>
  </class>

  <class name="eu.riscoss.api.model.RiskModel" table="RISKMODELS">
    <id name="id"/>
    <property name="xml" type="text" not-null="true"/>
  </class>

  <class name="eu.riscoss.api.model.GoalModel" table="GOALMODELS">
    <id name="id"/>
    <property name="xml" type="text" not-null="true"/>
  </class>

  <class name="eu.riscoss.api.model.ImpactModel" table="IMPACTMODELS">
    <id name="id"/>
    <property name="xml" type="text" not-null="true"/>
  </class>

  <class name="eu.riscoss.api.model.questionnaire.Question" table="QUESTIONS">
    <id name="id"/>
    <property name="type">
      <type name="org.hibernate.type.EnumType">
        <param name="enumClass">eu.riscoss.api.model.questionnaire.Question$Type</param>
      </type>
    </property>
    <property name="question"/>
    <property name="help"/>
    <property name="possibleAnswersRaw" type="text"/>
    <property name="mandatory"/>
  </class>

  <class name="eu.riscoss.internal.AnswerWithScope" table="ANSWERS">
    <composite-id>
      <key-property name="questionId"/>
      <key-many-to-one name="scope"/>
    </composite-id>
    <property name="values" column="answerValues" type="text"/>
  </class>


</hibernate-mapping>